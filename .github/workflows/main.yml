name: Windows Local Deploy  # 流水线名称

on:
  push:
    branches: [ "main" ]    # 当代码推送到 main 分支时触发

jobs:
  deploy-to-pc:
    runs-on: self-hosted    # 关键！告诉 GitHub 使用你本地的 Windows Runner
    
    steps:
      # 1. 从 GitHub 仓库拉取最新的代码到你电脑的临时文件夹
      - name: Checkout Code
        uses: actions/checkout@v4

      # 2. 使用 PowerShell 执行具体的部署动作
      - name: Deploy to Local Folder
        shell: powershell    # 明确指定使用 PowerShell 执行命令
        run: |
          # 定义目标文件夹路径
          $destDir = "D:\Devops\my-devops-runner"
          
          # 如果文件夹不存在，则创建一个
          if (!(Test-Path $destDir)) {
              New-Item -ItemType Directory -Path $destDir
              Write-Host "创建了新目录: $destDir"
          }
          
          # 将刚才下载的 index.html 拷贝到目标文件夹
          # $GITHUB_WORKSPACE 是 GitHub 默认的代码存放位置
          Copy-Item -Path "index.html" -Destination "$destDir\index.html" -Force
          
          Write-Host "--- 部署成功 ---"
          Write-Host "你现在可以去 $destDir 看看你的网页了！"
